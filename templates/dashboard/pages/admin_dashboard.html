{% extends 'dashboard/components/base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.css">

{% endblock %}

{% block content %}
<section class="px-4 sm:px-6 lg:px-8 py-6">

  <!-- Page Heading -->
  <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-6">Admin Dashboard</h1>

  <!-- Summary Cards -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-6 mb-8">

    <!-- Users Card -->
    <div class="bg-white p-5 sm:p-6 rounded-lg shadow border border-gray-200 flex flex-col gap-2">
      <h3 class="font-semibold text-gray-700 mb-2"><i class="fas fa-users mr-2 text-blue-500"></i> Users</h3>
      <p class="text-gray-600 text-sm">Total: <span class="font-bold">{{ total_users }}</span></p>
      <p class="text-gray-600 text-sm"><i class="fas fa-user text-blue-400"></i> Customers: <span class="font-bold">{{ customers_count }}</span></p>
      <p class="text-gray-600 text-sm"><i class="fas fa-store text-green-400"></i> Vendors: <span class="font-bold">{{ vendors_count }}</span></p>
      <p class="text-gray-600 text-sm"><i class="fas fa-user-shield text-yellow-500"></i> Admins: <span class="font-bold">{{ admins_count }}</span></p>
    </div>

    <!-- Vendors Card -->
    <div class="bg-white p-5 sm:p-6 rounded-lg shadow border border-gray-200 flex flex-col gap-2">
      <h3 class="font-semibold text-gray-700 mb-2"><i class="fas fa-store text-green-500 mr-2"></i> Vendors</h3>
      <p class="text-gray-600 text-sm">Total: <span class="font-bold">{{ total_vendors }}</span></p>
      <p class="text-gray-600 text-sm">Verified: <span class="font-bold text-green-600">{{ verified_vendors }}</span></p>
      <p class="text-gray-600 text-sm">Pending: <span class="font-bold text-yellow-600">{{ pending_vendors }}</span></p>
    </div>

    <!-- Products Card -->
    <div class="bg-white p-5 sm:p-6 rounded-lg shadow border border-gray-200 flex flex-col gap-2">
      <h3 class="font-semibold text-gray-700 mb-2"><i class="fas fa-boxes text-purple-500 mr-2"></i> Products</h3>
      <p class="text-gray-600 text-sm">Total: <span class="font-bold">{{ total_products }}</span></p>
      <p class="text-gray-600 text-sm">Active: <span class="font-bold text-green-600">{{ active_products }}</span></p>
      <p class="text-gray-600 text-sm">Low Stock: <span class="font-bold text-red-600">{{ low_stock_products }}</span></p>
    </div>

    <!-- Orders Card -->
    <div class="bg-white p-5 sm:p-6 rounded-lg shadow border border-gray-200 flex flex-col gap-2">
      <h3 class="font-semibold text-gray-700 mb-2"><i class="fas fa-shopping-cart text-orange-500 mr-2"></i> Orders</h3>
      <p class="text-gray-600 text-sm">Total: <span class="font-bold">{{ total_orders }}</span></p>
      <p class="text-gray-600 text-sm">Pending: <span class="font-bold text-yellow-600">{{ pending_orders }}</span></p>
      <p class="text-gray-600 text-sm">Delivered: <span class="font-bold text-green-600">{{ delivered_orders }}</span></p>
      <p class="text-gray-600 text-sm">Revenue: <span class="font-bold text-blue-600">Rs. {{ total_revenue }}</span></p>
    </div>

    <!-- Content Card -->
    <div class="bg-white p-5 sm:p-6 rounded-lg shadow border border-gray-200 flex flex-col gap-2">
      <h3 class="font-semibold text-gray-700 mb-2"><i class="fas fa-photo-video text-pink-500 mr-2"></i> Content</h3>
      <p class="text-gray-600 text-sm">Active Sliders: <span class="font-bold">{{ active_sliders }}</span></p>
      <p class="text-gray-600 text-sm">Active Banners: <span class="font-bold">{{ active_banners }}</span></p>
      <p class="text-gray-600 text-sm">Home Categories: <span class="font-bold">{{ active_home_categories }}</span></p>
    </div>

    <!-- Others Card -->
    <div class="bg-white p-5 sm:p-6 rounded-lg shadow border border-gray-200 flex flex-col gap-2">
      <h3 class="font-semibold text-gray-700 mb-2"><i class="fas fa-ellipsis-h text-gray-500 mr-2"></i> Others</h3>
      <p class="text-gray-600 text-sm">Reviews: <span class="font-bold">{{ total_reviews }}</span></p>
      <p class="text-gray-600 text-sm">Unread Contacts: <span class="font-bold text-red-600">{{ unread_contacts }}</span></p>
      <p class="text-gray-600 text-sm">Newsletter Subscribers: <span class="font-bold">{{ newsletter_subscribers }}</span></p>
      <p class="text-gray-600 text-sm">Unread Notifications: <span class="font-bold text-yellow-600">{{ unread_notifications }}</span></p>
    </div>

  </div>

  <!-- Charts Section -->
  <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-6 mb-8">
    <div class="bg-white p-5 sm:p-6 rounded-lg shadow border border-gray-200">
      <h3 class="font-semibold text-gray-700 mb-4"><i class="fas fa-chart-pie text-blue-500 mr-2"></i> User Breakdown</h3>
      <canvas id="userChart" class="w-full h-64 sm:h-72"></canvas>
    </div>
    <div class="bg-white p-5 sm:p-6 rounded-lg shadow border border-gray-200">
      <h3 class="font-semibold text-gray-700 mb-4"><i class="fas fa-store text-green-500 mr-2"></i> Vendor Status</h3>
      <canvas id="vendorChart" class="w-full h-64 sm:h-72"></canvas>
    </div>
    <div class="bg-white p-5 sm:p-6 rounded-lg shadow border border-gray-200">
      <h3 class="font-semibold text-gray-700 mb-4"><i class="fas fa-boxes text-purple-500 mr-2"></i> Product Status</h3>
      <canvas id="productChart" class="w-full h-64 sm:h-72"></canvas>
    </div>
    <div class="bg-white p-5 sm:p-6 rounded-lg shadow border border-gray-200">
      <h3 class="font-semibold text-gray-700 mb-4"><i class="fas fa-shopping-cart text-orange-500 mr-2"></i> Order Status</h3>
      <canvas id="orderChart" class="w-full h-64 sm:h-72"></canvas>
    </div>
  </div>

</section>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
<script>
  const userChart = new Chart(document.getElementById('userChart'), {
    type: 'pie',
    data: {
      labels: ['Customers', 'Vendors'],
      datasets: [{ data: [{{ customers_count }}, {{ vendors_count }}], backgroundColor: ['#3b82f6','#10b981'] }]
    }
  });

  const vendorChart = new Chart(document.getElementById('vendorChart'), {
    type: 'pie',
    data: {
      labels: ['Verified','Pending'],
      datasets: [{ data: [{{ verified_vendors }}, {{ pending_vendors }}], backgroundColor: ['#10b981','#f59e0b'] }]
    }
  });

  const productChart = new Chart(document.getElementById('productChart'), {
    type: 'bar',
    data: {
      labels: ['Total','Active','Low Stock'],
      datasets: [{ label: 'Products', data: [{{ total_products }}, {{ active_products }}, {{ low_stock_products }}], backgroundColor: ['#3b82f6','#10b981','#f59e0b'] }]
    },
    options: { responsive: true, plugins: { legend: { display: false } }, maintainAspectRatio: false }
  });

  const orderChart = new Chart(document.getElementById('orderChart'), {
    type: 'bar',
    data: {
      labels: ['Total','Pending','Delivered'],
      datasets: [{ label: 'Orders', data: [{{ total_orders }}, {{ pending_orders }}, {{ delivered_orders }}], backgroundColor: ['#3b82f6','#f59e0b','#10b981'] }]
    },
    options: { responsive: true, plugins: { legend: { display: false } }, maintainAspectRatio: false }
  });
</script>
{% endblock %}
