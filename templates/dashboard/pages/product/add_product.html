{% extends 'dashboard/components/base.html' %}
{% load static %}

{% block content %}
<div class="bg-white rounded-xl shadow p-6">
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-2xl font-semibold text-gray-800">Add Product</h1>
    <a href="{% url 'admin_products_list' %}" class="text-sm text-blue-600 hover:text-blue-800">Back to list</a>
  </div>

  <form method="post" action="{% url 'admin_product_add' %}" enctype="multipart/form-data" class="space-y-6">
    {% csrf_token %}

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <label class="block text-sm font-medium text-gray-700">Vendor</label>
        <select name="vendor" class="mt-1 block w-full border border-gray-300 rounded-lg p-2.5" required>
          {% for v in vendors %}
            <option value="{{ v.id }}">{{ v.shop_name }}</option>
          {% endfor %}
        </select>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">Category</label>
        <select name="category" class="mt-1 block w-full border border-gray-300 rounded-lg p-2.5" required>
          {% for c in categories %}
            <option value="{{ c.id }}">{{ c.name }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="md:col-span-2">
        <label class="block text-sm font-medium text-gray-700">Name</label>
        <input type="text" name="name" class="mt-1 block w-full border border-gray-300 rounded-lg p-2.5" required>
      </div>

      <div class="md:col-span-2">
        <label class="block text-sm font-medium text-gray-700">Description</label>
        <textarea id="description" name="description" rows="4" class="mt-1 block w-full border border-gray-300 rounded-lg p-2.5" required></textarea>

      </div>

      

      <div>
        <label class="block text-sm font-medium text-gray-700">Price</label>
        <input type="number" step="0.01" name="price" class="mt-1 block w-full border border-gray-300 rounded-lg p-2.5" required>
      </div>

      

      <div>
        <label class="block text-sm font-medium text-gray-700">Cost Price</label>
        <input type="number" step="0.01" name="cost_price" class="mt-1 block w-full border border-gray-300 rounded-lg p-2.5">
      </div>


      <div>
        <label class="block text-sm font-medium text-gray-700">Stock</label>
        <input type="number" name="stock" class="mt-1 block w-full border border-gray-300 rounded-lg p-2.5" value="0" required>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">Low Stock Alert</label>
        <input type="number" name="low_stock_alert" class="mt-1 block w-full border border-gray-300 rounded-lg p-2.5" value="5">
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">Brand</label>
        <input type="text" name="brand" class="mt-1 block w-full border border-gray-300 rounded-lg p-2.5">
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">Weight (kg)</label>
        <input type="number" step="0.01" name="weight" class="mt-1 block w-full border border-gray-300 rounded-lg p-2.5">
      </div>

      <div class="md:col-span-2 pt-2">
        <label class="inline-flex items-center text-sm text-gray-700">
          <input type="checkbox" name="is_featured" class="mr-2">
          Featured product
        </label>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">Main Image</label>
        <input type="file" name="main_image" accept="image/*" class="mt-1 block w-full">
      </div>

      <div class="md:col-span-2">
        <label class="block text-sm font-medium text-gray-700">Gallery Images</label>
        <input type="file" name="gallery_images" accept="image/*" class="mt-1 block w-full" multiple>
        <p class="text-xs text-gray-500 mt-1">You can select multiple images.</p>
      </div>

     

      
    </div>

    <div class="pt-2">
      <h2 class="text-lg font-semibold text-gray-800 mb-2">Variants</h2>
      <div id="variantsContainer" class="space-y-3"></div>
      <button type="button" id="addVariantBtn" class="mt-2 bg-gray-200 text-gray-800 px-3 py-1 rounded">+ Add Variant</button>
    </div>

    <div class="pt-4">
      <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">Save Product</button>
    </div>
  </form>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.ckeditor.com/4.21.0/standard/ckeditor.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const textarea = document.querySelector('textarea[name="description"]');
    if (textarea) {
      CKEDITOR.replace('description', {
        height: 300,
        toolbar: [
          { name: 'basicstyles', items: ['Bold', 'Italic', 'Underline', 'Strike'] },
          { name: 'paragraph', items: [
              'NumberedList', 'BulletedList', '-', 
              'JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock'
          ]},
          { name: 'styles', items: ['Font', 'FontSize'] },
          { name: 'colors', items: ['TextColor', 'BGColor'] },
          { name: 'insert', items: ['Link', 'Unlink', 'Image'] },
          { name: 'tools', items: ['RemoveFormat', 'Source'] } // optional tools
        ],
        removePlugins: 'elementspath', // hide element path at bottom
        resize_enabled: false,
        font_names: 'Arial;Comic Sans MS;Courier New;Georgia;Tahoma;Times New Roman;Verdana',
        fontSize_sizes: '12/12px;14/14px;16/16px;18/18px;20/20px;24/24px;28/28px'
      });
    }
  });
</script>




<script>
  (function(){
    const variantsContainer = document.getElementById('variantsContainer');
    const addVariantBtn = document.getElementById('addVariantBtn');
    addVariantBtn.addEventListener('click', function(){
      const row = document.createElement('div');
      row.className = 'grid grid-cols-1 md:grid-cols-5 gap-3 items-end';
      row.innerHTML = `
        <div>
          <label class="block text-sm font-medium text-gray-700">Type</label>
          <select name="variant_type[]" class="mt-1 block w-full border border-gray-300 rounded-lg p-2.5">
            <option value="size">Size</option>
    <option value="color">Color</option>
    <option value="weight">Weight</option>
    <option value="storage">Storage Capacity</option>
    <option value="ram">RAM</option>
    <option value="material">Material</option>
    <option value="style">Style</option>
    <option value="pattern">Pattern</option>
    <option value="flavor">Flavor</option>
    <option value="other" selected>Other</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Name</label>
          <input type="text" name="variant_name[]" class="mt-1 block w-full border border-gray-300 rounded-lg p-2.5" placeholder="e.g., XL, Red" />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Price Adj.</label>
          <input type="number" step="0.01" name="variant_price_adjustment[]" class="mt-1 block w-full border border-gray-300 rounded-lg p-2.5" value="0" />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Stock</label>
          <input type="number" name="variant_stock[]" class="mt-1 block w-full border border-gray-300 rounded-lg p-2.5" value="0" />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">SKU</label>
          <input type="text" name="variant_sku[]" class="mt-1 block w-full border border-gray-300 rounded-lg p-2.5" />
        </div>
      `;
      variantsContainer.appendChild(row);
    });
  })();
</script>
{% endblock %}


