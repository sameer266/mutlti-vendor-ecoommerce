<aside
  id="sidebar"
  class="bg-white border-r border-gray-200 w-[250px] fixed inset-y-0 left-0 transform transition-transform duration-300 md:translate-x-0 -translate-x-full z-30 flex flex-col pb-6"
  aria-label="Main navigation"
>
  <!-- Logo Section -->
  <div class="px-0 py-0 h-16 flex items-center border-b border-gray-200">
    <a href="{% if request.user.role.role == 'admin' %}{% url 'admin_dashboard' %}{% else %}{% url 'vendor_dashboard' %}{% endif %}" 
       class="flex items-center justify-center w-full h-full" 
       aria-label="Hello Bazar Dashboard">
      <img src="../../../static/Hello_bajar_Logo_1.png" alt="Hello Bazar Logo" class="h-full w-full object-contain">
    </a>
  </div>

  {% if request.user.role.role == 'admin' %}
  <!-- Admin Main Navigation -->
  <nav class="flex-grow overflow-y-auto py-4 text-md" aria-label="Sidebar navigation">
    <ul class="space-y-1 px-2">
      <!-- Dashboard -->
      <li>
        <a href="{% url 'admin_dashboard' %}" class="sidebar-link flex items-center px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-tachometer-alt w-6 text-center text-gray-500 mr-3"></i>
          <span>Dashboard</span>
        </a>
      </li>

      <!-- User Management -->
      <li>
        <button class="sidebar-dropdown-toggle flex items-center w-full px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-users-cog w-6 text-center text-gray-500 mr-3"></i>
          <span>User</span>
          <i class="dropdown-icon fas fa-chevron-down text-xs ml-auto transition-transform duration-200"></i>
        </button>
        <ul class="sidebar-submenu hidden pl-6 mt-1">
          <li>
            <a href="{% url 'admin_users_list' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-users w-5 text-center mr-3"></i>
              All Users
            </a>
          </li>
        </ul>
      </li>

      <!-- Vendor Management -->
      <li>
        <button class="sidebar-dropdown-toggle flex items-center w-full px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-store-alt w-6 text-center text-gray-500 mr-3"></i>
          <span>Vendor</span>
          <i class="dropdown-icon fas fa-chevron-down text-xs ml-auto transition-transform duration-200"></i>
        </button>
        <ul class="sidebar-submenu hidden pl-6 mt-1">
          <li>
            <a href="{% url 'admin_vendors_list' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-list w-5 text-center mr-3"></i>
              All Vendors
            </a>
          </li>
          <li>
            <a href="{% url 'admin_vendors_pending_kyc' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-hourglass-half w-5 text-center mr-3"></i>
              Pending Vendors
            </a>
          </li>
          <li>
            <a href="{% url 'admin_vendors_verified_kyc' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-check-circle w-5 text-center mr-3"></i>
              Verified Vendors
            </a>
          </li>
          <li>
            <a href="{% url 'admin_payments_overview' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-wallet w-5 text-center mr-3"></i>
              Vendor Payments Overview
            </a>
          </li>
        </ul>
      </li>

      <!-- Product Management -->
      <li>
        <button class="sidebar-dropdown-toggle flex items-center w-full px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-box w-6 text-center text-gray-500 mr-3"></i>
          <span>Product</span>
          <i class="dropdown-icon fas fa-chevron-down text-xs ml-auto transition-transform duration-200"></i>
        </button>
        <ul class="sidebar-submenu hidden pl-6 mt-1">
          <li>
            <a href="{% url 'admin_products_list' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-boxes w-5 text-center mr-3"></i>
              All Products
            </a>
          </li>
          <li>
            <a href="{% url 'admin_products_featured' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-star w-5 text-center mr-3"></i>
              Featured Products
            </a>
          </li>
          <li>
            <a href="{% url 'admin_products_low_stock' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-exclamation-triangle w-5 text-center mr-3"></i>
              Low Stock
            </a>
          </li>
        </ul>
      </li>

      <!-- Category Management -->
      <li>
        <a href="{% url 'admin_categories_list' %}" class="sidebar-link flex items-center px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-tags w-6 text-center text-gray-500 mr-3"></i>
          <span>Category</span>
        </a>
      </li>

      <!-- Order Management -->
      <li>
        <button class="sidebar-dropdown-toggle flex items-center w-full px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-shopping-cart w-6 text-center text-gray-500 mr-3"></i>
          <span>Order</span>
          <i class="dropdown-icon fas fa-chevron-down text-xs ml-auto transition-transform duration-200"></i>
        </button>
        <ul class="sidebar-submenu hidden pl-6 mt-1">
          <li>
            <a href="{% url 'admin_orders_list' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-list w-5 text-center mr-3"></i>
              All Orders
            </a>
          </li>
          <li>
            <a href="{% url 'admin_orders_pending' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-hourglass-half w-5 text-center mr-3"></i>
              Pending Orders
            </a>
          </li>
          <li>
            <a href="{% url 'admin_orders_delivered' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-check-circle w-5 text-center mr-3"></i>
              Delivered Orders
            </a>
          </li>
        </ul>
      </li>

      <!-- Payout Requests -->
      <li>
        <button class="sidebar-dropdown-toggle flex items-center w-full px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-file-invoice-dollar w-6 text-center text-gray-500 mr-3"></i>
          <span>Payout</span>
          <i class="dropdown-icon fas fa-chevron-down text-xs ml-auto transition-transform duration-200"></i>
        </button>
        <ul class="sidebar-submenu hidden pl-6 mt-1">
          <li>
            <a href="{% url 'admin_payout_requests_list' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-list w-5 text-center mr-3"></i>
              All Requests
            </a>
          </li>
          <li>
            <a href="{% url 'admin_payout_requests_pending' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-hourglass-half w-5 text-center mr-3"></i>
              Pending
            </a>
          </li>
          <li>
            <a href="{% url 'admin_payout_requests_rejected' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-times-circle w-5 text-center mr-3"></i>
              Rejected
            </a>
          </li>
        </ul>
      </li>

      <!-- Content Management -->
      <li>
        <button class="sidebar-dropdown-toggle flex items-center w-full px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-images w-6 text-center text-gray-500 mr-3"></i>
          <span>Content</span>
          <i class="dropdown-icon fas fa-chevron-down text-xs ml-auto transition-transform duration-200"></i>
        </button>
        <ul class="sidebar-submenu hidden pl-6 mt-1">
          <li>
            <a href="{% url 'admin_sliders_list' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-sliders-h w-5 text-center mr-3"></i>
              Sliders
            </a>
          </li>
          <li>
            <a href="{% url 'admin_banners_list' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-image w-5 text-center mr-3"></i>
              Banners
            </a>
          </li>

        </ul>
      </li>

      <!-- Contact Management -->
      <li>
        <button class="sidebar-dropdown-toggle flex items-center w-full px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-envelope w-6 text-center text-gray-500 mr-3"></i>
          <span>Contact</span>
          <i class="dropdown-icon fas fa-chevron-down text-xs ml-auto transition-transform duration-200"></i>
        </button>
        <ul class="sidebar-submenu hidden pl-6 mt-1">
          <li>
            <a href="{% url 'admin_contacts_list' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-inbox w-5 text-center mr-3"></i>
              All Contacts
            </a>
          </li>
          <li>
            <a href="{% url 'admin_contact_unread'%}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-envelope-open w-5 text-center mr-3"></i>
              Unread Contacts
            </a>
          </li>
        </ul>
      </li>

      <!-- Review Management -->
      <li>
        <a href="{% url 'admin_reviews_list' %}" class="sidebar-link flex items-center px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-star w-6 text-center text-gray-500 mr-3"></i>
          <span>Review</span>
        </a>
      </li>

      <!-- Newsletter Management -->
      <li>
        <a href="{% url 'admin_newsletter_list' %}" class="sidebar-link flex items-center px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-newspaper w-6 text-center text-gray-500 mr-3"></i>
          <span>Newsletter</span>
        </a>
      </li>

      <!-- Coupon Management -->
      <li>
        <a href="{% url 'admin_coupons_list' %}" class="sidebar-link flex items-center px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-ticket-alt w-6 text-center text-gray-500 mr-3"></i>
          <span>Coupons</span>
        </a>
      </li>

      <!-- Organization Management -->
      <li>
        <a href="{% url 'admin_organization_view' %}" class="sidebar-link flex items-center px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-building w-6 text-center text-gray-500 mr-3"></i>
          <span>Organization</span>
        </a>
      </li>

       <li>
        <a href="{% url 'admin_profile' %}" class="sidebar-link flex items-center px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-user w-6 text-center text-gray-500 mr-3"></i>
          <span>Profile</span>
        </a>
      </li>
    </ul>
  </nav>

  {% elif request.user.role.role == 'vendor' %}
  <!-- Vendor Main Navigation -->
  <nav class="flex-grow overflow-y-auto py-4 text-md" aria-label="Sidebar navigation">
    <ul class="space-y-1 px-2">
      <!-- Dashboard -->
      <li>
        <a href="{% url 'vendor_dashboard' %}" class="sidebar-link flex items-center px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-tachometer-alt w-6 text-center text-gray-500 mr-3"></i>
          <span>Dashboard</span>
        </a>
      </li>

      <!-- Products -->
      <li>
        <button class="sidebar-dropdown-toggle flex items-center w-full px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-box w-6 text-center text-gray-500 mr-3"></i>
          <span>Products</span>
          <i class="dropdown-icon fas fa-chevron-down text-xs ml-auto transition-transform duration-200"></i>
        </button>
        <ul class="sidebar-submenu hidden pl-6 mt-1">
          <li>
            <a href="{% url 'vendor_products_list' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-boxes w-5 text-center mr-3"></i>
              All Products
            </a>
          </li>
          <li>
            <a href="{% url 'vendor_product_add'%}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-plus w-5 text-center mr-3"></i>
              Add Product
            </a>
          </li>

            <li>
            <a href="{% url 'vendor_products_low_stock' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-exclamation-triangle w-5 text-center mr-3"></i>
              Low Stock
            </a>
          </li>

        </ul>
      </li>

      <!-- Orders -->
      <li>
        <button class="sidebar-dropdown-toggle flex items-center w-full px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-shopping-cart w-6 text-center text-gray-500 mr-3"></i>
          <span>Orders</span>
          <i class="dropdown-icon fas fa-chevron-down text-xs ml-auto transition-transform duration-200"></i>
        </button>
        <ul class="sidebar-submenu hidden pl-6 mt-1">
          <li>
            <a href="{% url 'vendor_orders_list'%}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-list w-5 text-center mr-3"></i>
              All Orders
            </a>
          </li>
          <li>
            <a href="{% url 'vendor_orders_pending' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-hourglass-half w-5 text-center mr-3"></i>
              Pending Orders
            </a>
          </li>
          <li>
            <a href="{% url 'vendor_orders_delivered' %}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-check-circle w-5 text-center mr-3"></i>
              Delivered Orders
            </a>
          </li>
        </ul>
      </li>
<!-- Payouts -->
   <li>
        <button class="sidebar-dropdown-toggle flex items-center w-full px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-file-invoice-dollar w-6 text-center text-gray-500 mr-3"></i>
          <span>Payout</span>
          <i class="dropdown-icon fas fa-chevron-down text-xs ml-auto transition-transform duration-200"></i>
        </button>
        <ul class="sidebar-submenu hidden pl-6 mt-1">
          <li>
            <a href="{% url 'vendor_payout_list'%}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-list w-5 text-center mr-3"></i>
              All Requests
            </a>
          </li>
          <li>
            <a href="{% url 'vendor_pending_payout'%}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-hourglass-half w-5 text-center mr-3"></i>
              Pending
            </a>
          </li>
          <li>
            <a href="{% url 'vendor_pending_payout'%}" class="sublink flex items-center px-4 py-2 rounded-md text-gray-600 font-normal text-sm hover:bg-gray-100 transition-all duration-200">
              <i class="fas fa-times-circle w-5 text-center mr-3"></i>
              Rejected
            </a>
          </li>
        </ul>
      </li>
      <!-- Payments -->
      <li>
        <a href="{% url 'vendor_wallet_view'%}" class="sidebar-link flex items-center px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-wallet w-6 text-center text-gray-500 mr-3"></i>
          <span>Wallets</span>
        </a>
      </li>

      <!-- Profile -->
      <li>
        <a href="{% url 'vendor_profile' %}" class="sidebar-link flex items-center px-4 py-2 rounded-md text-gray-600 font-medium hover:bg-gray-100 transition-all duration-200">
          <i class="fas fa-user w-6 text-center text-gray-500 mr-3"></i>
          <span>Profile</span>
        </a>
      </li>
    </ul>
  </nav>
  {% endif %}

  <!-- Bottom Section -->
  <div class="border-t border-gray-200 pt-2 px-2">
    <ul class="space-y-1">
      <li>
        <a href="{% url 'logout' %}" class="flex items-center px-4 py-2 rounded-md text-red-600 font-medium hover:bg-red-50 transition-all duration-200">
          <i class="fas fa-sign-out-alt w-6 text-center mr-3"></i>
          Logout
        </a>
      </li>
    </ul>
  </div>
</aside>

<!-- Overlay for mobile -->
<div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-20 hidden md:hidden"></div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Toggle mobile sidebar
  const menuButton = document.getElementById('mobile-menu-button');
  const sidebar = document.getElementById('sidebar');
  const overlay = document.getElementById('sidebar-overlay');

  if (menuButton) {
    menuButton.addEventListener('click', function() {
      sidebar.classList.toggle('-translate-x-full');
      overlay.classList.toggle('hidden');
      document.body.classList.toggle('overflow-hidden');
      
      const icon = this.querySelector('i');
      if (icon) {
        icon.classList.toggle('fa-bars');
        icon.classList.toggle('fa-times');
      }
    });
  }

  // Close sidebar when clicking overlay
  if (overlay) {
    overlay.addEventListener('click', function() {
      sidebar.classList.add('-translate-x-full');
      this.classList.add('hidden');
      document.body.classList.remove('overflow-hidden');
      
      if (menuButton) {
        const icon = menuButton.querySelector('i');
        if (icon) {
          icon.classList.remove('fa-times');
          icon.classList.add('fa-bars');
        }
      }
    });
  }

  // Dropdown toggle functionality - Works for both admin and vendor
  const dropdownToggles = document.querySelectorAll('.sidebar-dropdown-toggle');
  
  dropdownToggles.forEach(toggle => {
    toggle.addEventListener('click', function(e) {
      e.preventDefault();
      e.stopPropagation();
      
      const submenu = this.nextElementSibling;
      const icon = this.querySelector('.dropdown-icon');
      const parentLi = this.parentElement;
      
      // Close other dropdowns at the same level
      const siblings = Array.from(parentLi.parentElement.children);
      siblings.forEach(sibling => {
        if (sibling !== parentLi) {
          const siblingSubmenu = sibling.querySelector('.sidebar-submenu');
          const siblingIcon = sibling.querySelector('.dropdown-icon');
          if (siblingSubmenu) {
            siblingSubmenu.classList.add('hidden');
          }
          if (siblingIcon) {
            siblingIcon.classList.remove('rotate-180');
          }
        }
      });
      
      // Toggle current dropdown
      if (submenu) {
        submenu.classList.toggle('hidden');
      }
      if (icon) {
        icon.classList.toggle('rotate-180');
      }
    });
  });

  // Highlight active links
  function highlightActiveLinks() {
    const currentPath = window.location.pathname;
    
    // Remove active classes from all links
    document.querySelectorAll('.sidebar-link, .sublink').forEach(link => {
      link.classList.remove('active', 'bg-blue-50', 'text-blue-600', 'font-semibold');
    });
    
    // Add active class to matching links
    document.querySelectorAll('.sidebar-link, .sublink').forEach(link => {
      const linkPath = link.getAttribute('href');
      
      if (linkPath && (currentPath === linkPath || (linkPath !== '/' && currentPath.startsWith(linkPath)))) {
        link.classList.add('active', 'bg-blue-50', 'text-blue-600', 'font-semibold');
        
        // If it's a sublink, open the parent menu
        if (link.classList.contains('sublink')) {
          const submenu = link.closest('.sidebar-submenu');
          if (submenu) {
            submenu.classList.remove('hidden');
            const toggle = submenu.previousElementSibling;
            if (toggle) {
              const icon = toggle.querySelector('.dropdown-icon');
              if (icon) {
                icon.classList.add('rotate-180');
              }
            }
          }
        }
      }
    });
  }
  
  // Initial highlight
  highlightActiveLinks();
  
  // Update on navigation
  window.addEventListener('popstate', highlightActiveLinks);
});
</script>