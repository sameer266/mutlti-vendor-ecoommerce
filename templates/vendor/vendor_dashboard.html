{% extends 'dashboard/components/base.html' %}
{% load static %}

{% block content %}
<section class="px-4 sm:px-6 lg:px-8 py-6">

  <!-- Page Heading -->
  <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-6 flex items-center gap-2">
    <i class="fas fa-store text-blue-600"></i> Vendor Dashboard
  </h1>

  <!-- Summary Cards -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
    
    <!-- Products Card -->
    <div class="bg-white p-5 sm:p-6 rounded-lg shadow border border-gray-200 hover:shadow-lg transition">
      <div class="flex items-center gap-3 mb-3">
        <i class="fas fa-boxes text-2xl text-blue-500"></i>
        <h3 class="font-semibold text-gray-700">Products</h3>
      </div>
      <p class="text-gray-600 text-sm"><i class="fas fa-list-ul mr-1"></i> Total: {{ total_products }}</p>
      <p class="text-gray-600 text-sm"><i class="fas fa-check-circle mr-1"></i> Active: {{ active_products }}</p>
      <p class="text-gray-600 text-sm"><i class="fas fa-exclamation-triangle mr-1 text-yellow-600"></i> Low Stock: <span class="font-semibold">{{ low_stock_products }}</span></p>
    </div>

    <!-- Orders Card -->
    <div class="bg-white p-5 sm:p-6 rounded-lg shadow border border-gray-200 hover:shadow-lg transition">
      <div class="flex items-center gap-3 mb-3">
        <i class="fas fa-shopping-cart text-2xl text-green-500"></i>
        <h3 class="font-semibold text-gray-700">Orders</h3>
      </div>
      <p class="text-gray-600 text-sm"><i class="fas fa-list-ul mr-1"></i> Total: {{ total_orders }}</p>
      <p class="text-gray-600 text-sm"><i class="fas fa-clock mr-1 text-yellow-600"></i> Pending: <span class="font-semibold">{{ pending_orders }}</span></p>
      <p class="text-gray-600 text-sm"><i class="fas fa-check mr-1 text-green-600"></i> Delivered: <span class="font-semibold">{{ delivered_orders }}</span></p>
      <p class="text-gray-600 text-sm"><i class="fas fa-money-bill-wave mr-1"></i> Revenue: Rs. <span class="font-semibold">{{ total_revenue }}</span></p>
    </div>

    <!-- Profile Card -->
    <div class="bg-white p-5 sm:p-6 rounded-lg shadow border border-gray-200 hover:shadow-lg transition">
      <div class="flex items-center gap-3 mb-3">
        <i class="fas fa-user-circle text-2xl text-purple-500"></i>
        <h3 class="font-semibold text-gray-700">Profile</h3>
      </div>
      <p class="text-gray-600 text-sm"><i class="fas fa-user mr-1"></i> Name: {{ request.user.get_full_name }}</p>
      <p class="text-gray-600 text-sm"><i class="fas fa-envelope mr-1"></i> Email: {{ request.user.email }}</p>
      <p class="text-gray-600 text-sm"><i class="fas fa-store mr-1"></i> Shop: {{ request.user.vendor_profile.shop_name }}</p>
    </div>

  </div>

  <!-- Charts Section -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    
    <!-- Orders Status Pie Chart -->
    <div class="bg-white p-5 sm:p-6 rounded-lg shadow border border-gray-200 hover:shadow-lg transition">
      <h3 class="font-semibold text-gray-700 mb-4 flex items-center gap-2">
        <i class="fas fa-chart-pie text-blue-500"></i> Orders Status
      </h3>
      <canvas id="orderChart" class="w-full h-64 sm:h-72"></canvas>
    </div>

    <!-- Product Stock Bar Chart -->
    <div class="bg-white p-5 sm:p-6 rounded-lg shadow border border-gray-200 hover:shadow-lg transition">
      <h3 class="font-semibold text-gray-700 mb-4 flex items-center gap-2">
        <i class="fas fa-box text-yellow-500"></i> Product Stock Status
      </h3>
      <canvas id="productChart" class="w-full h-64 sm:h-72"></canvas>
    </div>

  </div>

</section>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
<script>
  const orderChart = new Chart(document.getElementById('orderChart'), {
    type: 'pie',
    data: {
      labels: ['Pending', 'Delivered'],
      datasets: [{
        data: [{{ pending_orders }}, {{ delivered_orders }}],
        backgroundColor: ['#f59e0b','#10b981']
      }]
    },
    options: { plugins: { legend: { position: 'bottom' } } }
  });

  const productChart = new Chart(document.getElementById('productChart'), {
    type: 'bar',
    data: {
      labels: ['Total Products','Low Stock'],
      datasets: [{
        label: 'Products',
        data: [{{ total_products }}, {{ low_stock_products }}],
        backgroundColor: ['#3b82f6','#f59e0b']
      }]
    },
    options: { responsive: true, plugins: { legend: { display: false } }, maintainAspectRatio: false }
  });
</script>
{% endblock %}
